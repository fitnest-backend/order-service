server:
  port: 8080
  http2:
    enabled: true
  compression:
    enabled: true
    mime-types: application/json,text/plain,text/css,application/javascript,application/openapi+json,application/vnd.api+json
    min-response-size: 2048
  tomcat:
    threads:
      max: 200
      min-spare: 20
    connection-timeout: 20000
    max-connections: 8192
    accept-count: 100

spring:
  main:
    lazy-initialization: ${SPRING_MAIN_LAZY_INITIALIZATION:false}
  application:
    name: order-service
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://postgresql-order:5432/fitnest_order}
    username: ${SPRING_DATASOURCE_USERNAME:fitnest_order}
    password: ${SPRING_DATASOURCE_PASSWORD:order_password_123}
    driver-class-name: org.postgresql.Driver
    hikari:
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
      keep-alive-time: 300000
      minimum-idle: ${HIKARI_MIN_IDLE:2}
      maximum-pool-size: ${HIKARI_MAX_POOL:20}
      pool-name: HikariCP-Order
      auto-commit: true
      connection-test-query: SELECT 1
      data-source-properties:
        cachePrepStmts: true
        prepStmtCacheSize: 250
        prepStmtCacheSqlLimit: 2048
        useServerPrepStmts: true
        useLocalSessionState: true
        rewriteBatchedStatements: true
        cacheResultSetMetadata: true
        cacheServerConfiguration: true
        elideSetAutoCommits: true
        maintainTimeStats: false
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    open-in-view: false
    properties:
      hibernate:
        format_sql: false
  jackson:
    serialization:
      write-dates-as-timestamps: false

  data:
    redis:
      host: ${SPRING_REDIS_HOST:redis.fitnest-dev.svc.cluster.local}
      port: ${SPRING_REDIS_PORT:6379}
      password: ${SPRING_REDIS_PASSWORD:}
      timeout: 2000ms

  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:kafka-service.fitnest-dev.svc.cluster.local:9092}
    consumer:
      group-id: order-group
      auto-offset-reset: earliest
      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
      value-deserializer: org.apache.kafka.common.serialization.StringDeserializer
    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: org.apache.kafka.common.serialization.StringSerializer

  cloud:
    openfeign:
      client:
        config:
          default:
            connect-timeout: ${FEIGN_CONNECT_TIMEOUT:5000}
            read-timeout: ${FEIGN_READ_TIMEOUT:10000}
            logger-level: BASIC
      httpclient:
        hc5:
          enabled: true
          pool:
            max-connections: ${FEIGN_MAX_CONNECTIONS:50}
            max-connections-per-route: ${FEIGN_CONNECTIONS_PER_ROUTE:20}
            conn-pool-policy: LIFO

eureka:
  client:
    enabled: false

jwt:
  secret: ${JWT_SECRET:your-jwt-secret-change-in-production}
  issuer: ${JWT_ISSUER:fitnest}

identity:
  service:
    url: ${IDENTITY_SERVICE_URL:http://identity-service:8080}

catalog:
  service:
    url: ${CATALOG_SERVICE_URL:http://catalog-service:8080}

payment:
  service:
    url: ${PAYMENT_SERVICE_URL:http://payment-service:8080}

management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
  endpoint:
    health:
      show-details: when-authorized

springdoc:
  api-docs:
    path: /v3/api-docs
    cache:
      enabled: true
  paths-to-exclude: /api/v1/internal/**
  swagger-ui:
    enabled: true
    path: /swagger-ui.html
    doc-expansion: none
    filter: true
    display-request-duration: true
    try-it-out-enabled: true
    operations-sorter: alpha
    tags-sorter: alpha
  show-actuator: false
  default-consumes-media-type: application/json
  default-produces-media-type: application/json
  writer-with-default-pretty-printer: false

logging:
  level:
    az.fitnest.order: OFF
    feign.Logger: OFF

grpc:
  server:
    port: 9090
